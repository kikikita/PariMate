from aiogram import Router
from aiogram.types import ChatMemberUpdated
from aiogram.filters import ChatMemberUpdatedFilter, IS_MEMBER, IS_NOT_MEMBER
from core.database.bd import bd_user_select


router = Router()


def join_message(habit: str):
    # habit_list = [
    #     'Ð·Ð°Ð½Ð¸Ð¼Ð°Ñ‚ÑŒÑÑ ÑÐ¿Ð¾Ñ€Ñ‚Ð¾Ð¼', 'Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾ Ð¿Ð¸Ñ‚Ð°Ñ‚ÑŒÑÑ', 'Ð¿Ð¸Ñ‚ÑŒ Ð²Ð¾Ð´Ñƒ',
    #     'Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°Ñ‚ÑŒ Ð´Ð¾Ð±Ð°Ð²ÐºÐ¸', 'Ð´ÐµÐ»Ð°Ñ‚ÑŒ Ð·Ð°Ñ€ÑÐ´ÐºÑƒ', 'Ð³ÑƒÐ»ÑÑ‚ÑŒ',
    #     'Ð¸Ð·ÑƒÑ‡Ð°Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ð¹ Ð½Ð°Ð²Ñ‹Ðº', 'Ñ‡Ð¸Ñ‚Ð°Ñ‚ÑŒ', 'Ð¿Ñ€Ð¾Ñ…Ð¾Ð´Ð¸Ñ‚ÑŒ ÑƒÑ‡ÐµÐ±Ð½Ñ‹Ð¹ ÐºÑƒÑ€Ñ',
    #     'Ð²ÐµÑÑ‚Ð¸ Ð´Ð½ÐµÐ²Ð½Ð¸Ðº', 'Ð¸Ð·ÑƒÑ‡Ð°Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ð¹ ÑÐ·Ñ‹Ðº', 'Ð¼ÐµÐ´Ð¸Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ',
    #     'ÑÐ¾Ð±Ð»ÑŽÐ´Ð°Ñ‚ÑŒ Ñ€ÐµÐ¶Ð¸Ð¼ ÑÐ½Ð°', 'Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð½Ð° Ð´ÐµÐ½ÑŒ',
    #     'Ð¿Ñ€Ð¾Ð²Ð¾Ð´Ð¸Ñ‚ÑŒ Ð¼ÐµÐ½ÑŒÑˆÐµ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ Ð² Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ðµ']
    if habit == 'Ð·Ð°Ð½Ð¸Ð¼Ð°Ñ‚ÑŒÑÑ ÑÐ¿Ð¾Ñ€Ñ‚Ð¾Ð¼':
        text = 'Ð¿Ñ€Ð¸ÑÑ‹Ð»Ð°Ñ‚ÑŒ Ñ„Ð¾Ñ‚Ð¾/Ð²Ð¸Ð´ÐµÐ¾ Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ðµ Ñ„Ð¸Ð·Ð¸Ñ‡ÐµÑÐºÐ¾Ð¹ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸.'
    elif habit == 'Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾ Ð¿Ð¸Ñ‚Ð°Ñ‚ÑŒÑÑ':
        text = ('Ð¿Ñ€Ð¸ÑÑ‹Ð»Ð°Ñ‚ÑŒ Ñ„Ð¾Ñ‚Ð¾ ÐµÐ´Ñ‹, ÐºÐ¾Ñ‚Ð¾Ñ€ÑƒÑŽ Ð¿Ð¾Ñ‚Ñ€ÐµÐ±Ð»ÑÐµÑˆÑŒ/' +
                'ÑÐºÑ€Ð¸Ð½ÑˆÐ¾Ñ‚Ñ‹ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ð´Ð»Ñ Ð¿Ð¾Ð´ÑÑ‡ÐµÑ‚Ð° ÐºÐ°Ð»Ð¾Ñ€Ð¸Ð¹.')
    elif habit == 'Ð¿Ð¸Ñ‚ÑŒ Ð²Ð¾Ð´Ñƒ':
        text = ('Ð¿Ñ€Ð¸ÑÑ‹Ð»Ð°Ñ‚ÑŒ Ñ„Ð¾Ñ‚Ð¾ Ð½Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ð½Ð¾Ð¹ Ð±ÑƒÑ‚Ñ‹Ð»ÐºÐ¸ Ð²Ð¾Ð´Ñ‹ ÑƒÑ‚Ñ€Ð¾Ð¼, Ð° ' +
                'Ð²ÐµÑ‡ÐµÑ€Ð¾Ð¼ Ð¿Ñ€Ð¸ÑÐ»Ð°Ñ‚ÑŒ Ñ„Ð¾Ñ‚Ð¾ Ñ‚Ð¾Ð³Ð¾, Ñ‡Ñ‚Ð¾ Ð±ÑƒÑ‚Ñ‹Ð»ÐºÐ° Ð¿ÑƒÑÑ‚Ð°.')
    elif habit == 'Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°Ñ‚ÑŒ Ð´Ð¾Ð±Ð°Ð²ÐºÐ¸':
        text = 'ÐºÐ°Ð¶Ð´Ñ‹Ð¹ Ñ€Ð°Ð· Ð¿Ñ€Ð¸ÑÑ‹Ð»Ð°Ñ‚ÑŒ Ð´Ð¾Ð±Ð°Ð²Ð¾Ðº Ð´Ð¾ Ð¸Ñ… Ð¿Ñ€Ð¸ÐµÐ¼Ð°.'
    elif habit == 'Ð´ÐµÐ»Ð°Ñ‚ÑŒ Ð·Ð°Ñ€ÑÐ´ÐºÑƒ':
        text = 'Ð¿Ñ€Ð¸ÑÑ‹Ð»Ð°Ñ‚ÑŒ Ñ„Ð¾Ñ‚Ð¾/Ð²Ð¸Ð´ÐµÐ¾, ÐºÐ°Ðº Ð´ÐµÐ»Ð°ÐµÑˆÑŒ Ð·Ð°Ñ€ÑÐ´ÐºÑƒ Ñ ÑƒÑ‚Ñ€Ð°.'
    elif habit == 'Ð³ÑƒÐ»ÑÑ‚ÑŒ':
        text = 'Ð¿Ñ€Ð¸ÑÑ‹Ð»Ð°Ñ‚ÑŒ Ñ„Ð¾Ñ‚Ð¾/Ð²Ð¸Ð´ÐµÐ¾-ÐºÑ€ÑƒÐ¶Ð¾Ñ‡ÐºÐ¸ Ñ Ð¿Ñ€Ð¾Ð³ÑƒÐ»ÐºÐ¸.'
    elif habit == 'Ð¸Ð·ÑƒÑ‡Ð°Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ð¹ Ð½Ð°Ð²Ñ‹Ðº':
        text = 'Ð¿Ñ€Ð¸ÑÑ‹Ð»Ð°Ñ‚ÑŒ Ð²Ð¸Ð´ÐµÐ¾-ÐºÑ€ÑƒÐ¶Ð¾Ñ‡ÐµÐº Ñ Ñ‚ÐµÐ¼, ÐºÐ°Ðº Ñ€Ð°Ð·Ð²Ð¸Ð²Ð°ÐµÑˆÑŒ Ð½Ð¾Ð²Ñ‹Ð¹ Ð½Ð°Ð²Ñ‹Ðº.'
    elif habit == 'Ñ‡Ð¸Ñ‚Ð°Ñ‚ÑŒ':
        text = ('Ð¿Ñ€Ð¸ÑÑ‹Ð»Ð°Ñ‚ÑŒ ÐºÑ€ÑƒÐ¶Ð¾Ñ‡ÐµÐº Ñ Ñ‚ÐµÐ¼, ÐºÐ°Ðº Ñ‡Ð¸Ñ‚Ð°ÐµÑˆÑŒ, ' +
                'ÐºÑ€Ð°Ñ‚ÐºÐ¾ Ð¿ÐµÑ€ÐµÑÐºÐ°Ð·Ñ‹Ð²Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾Ñ‡Ð¸Ñ‚Ð°Ð½Ð½Ð¾Ðµ Ð·Ð° ÑÑ‚Ð¾Ñ‚ Ð¿Ð¾Ð´Ñ…Ð¾Ð´.')
    elif habit == 'Ð¿Ñ€Ð¾Ñ…Ð¾Ð´Ð¸Ñ‚ÑŒ ÑƒÑ‡ÐµÐ±Ð½Ñ‹Ð¹ ÐºÑƒÑ€Ñ':
        text = ('Ð¿Ñ€Ð¸ÑÑ‹Ð»Ð°Ñ‚ÑŒ ÑÐºÑ€Ð¸Ð½ÑˆÐ¾Ñ‚ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑÐ° ÐºÑƒÑ€ÑÐ°, Ð¾Ð¿Ð¸ÑÑ‹Ð²Ð°Ñ‚ÑŒ,' +
                'Ð¿Ñ€Ð¾Ð¹Ð´ÐµÐ½Ð½Ñ‹Ðµ ÑÑ‚Ð°Ð¿Ñ‹, ÐºÐ°ÐºÐ¸Ðµ Ð±Ñ‹Ð»Ð¸ ÑÐ»Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸.')
    elif habit == 'Ð²ÐµÑÑ‚Ð¸ Ð´Ð½ÐµÐ²Ð½Ð¸Ðº':
        text = ('Ð¿Ñ€Ð¸ÑÑ‹Ð»Ð°Ñ‚ÑŒ ÑÐºÑ€Ð¸Ð½ÑˆÐ¾Ñ‚/Ñ„Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸ÑŽ Ð·Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ð½Ð¾Ð³Ð¾ ' +
                'ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ Ð¼Ð¾Ð¶Ð½Ð¾ Ð·Ð°Ð±Ð»ÑŽÑ€Ð¸Ñ‚ÑŒ) Ð´Ð½ÐµÐ²Ð½Ð¸ÐºÐ°, Ð¾Ð¿Ð¸ÑÑ‹Ð²Ð°Ñ‚ÑŒ, ' +
                'Ð³Ð´Ðµ Ð±Ñ‹Ð»Ð¸ ÑÐ»Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸ Ð² Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ð¸ ÑÑ‚Ð¾Ð³Ð¾ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ.')
    elif habit == 'Ð¸Ð·ÑƒÑ‡Ð°Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ð¹ ÑÐ·Ñ‹Ðº':
        text = 'Ð¿Ñ€Ð¸ÑÑ‹Ð»Ð°Ñ‚ÑŒ Ñ„Ð¾Ñ‚Ð¾/Ð²Ð¸Ð´ÐµÐ¾/ÑÐºÑ€Ð¸Ð½ÑˆÐ¾Ñ‚Ñ‹ Ð¿Ñ€Ð¾Ð¹Ð´ÐµÐ½Ð½Ñ‹Ñ… Ð·Ð°Ð´Ð°Ð½Ð¸Ð¹/Ñ‚ÐµÑÑ‚Ð¾Ð².'
    elif habit == 'Ð¼ÐµÐ´Ð¸Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ':
        text = ('Ð¾Ð¿Ð¸ÑÑ‹Ð²Ð°Ñ‚ÑŒ, ÐºÐ°ÐºÐ¸Ðµ Ð±Ñ‹Ð»Ð¸ Ñ‚Ñ€ÑƒÐ´Ð½Ð¾ÑÑ‚Ð¸ Ð² Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ð¸ ' +
                'ÑÑ‚Ð¾Ð³Ð¾ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ, Ð° Ñ‚Ð°ÐºÐ¶Ðµ Ñ‚Ð¾, Ñ‡Ñ‚Ð¾ Ð±Ñ‹Ð»Ð¾ ÑƒÑÐ¿ÐµÑˆÐ½Ñ‹Ð¼/Ð¿Ñ€Ð¸ÑÑ‚Ð½Ñ‹Ð¼.')
    elif habit == 'ÑÐ¾Ð±Ð»ÑŽÐ´Ð°Ñ‚ÑŒ Ñ€ÐµÐ¶Ð¸Ð¼ ÑÐ½Ð°':
        text = ('Ð¿Ñ€Ð¸ÑÑ‹Ð»Ð°Ñ‚ÑŒ Ñ„Ð¾Ñ‚Ð¾/Ð²Ð¸Ð´ÐµÐ¾-ÐºÑ€ÑƒÐ¶Ð¾Ñ‡ÐºÐ¸ Ð² Ð½Ð°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ Ð¿Ð¾Ð´ÑŠÐµÐ¼Ð°,' +
                'Ð° Ñ‚Ð°ÐºÐ¶Ðµ Ð¿Ñ€Ð¸ÑÑ‹Ð»Ð°Ñ‚ÑŒ ÑÐºÑ€Ð¸Ð½ÑˆÐ¾Ñ‚ Ð¸Ð· Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ "Ð·Ð´Ð¾Ñ€Ð¾Ð²ÑŒÐµ".')
    elif habit == 'Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð½Ð° Ð´ÐµÐ½ÑŒ':
        text = ('Ð¿Ñ€Ð¸ÑÑ‹Ð»Ð°Ñ‚ÑŒ Ñ„Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸ÑŽ/ÑÐºÑ€Ð¸Ð½ÑˆÐ¾Ñ‚/ Ð·Ð°Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ñ… Ð´ÐµÐ»,' +
                'Ð¾Ð¿Ð¸ÑÑ‹Ð²Ð°Ñ‚ÑŒ, Ð³Ð´Ðµ Ð±Ñ‹Ð»Ð¸ Ñ‚Ñ€ÑƒÐ´Ð½Ð¾ÑÑ‚Ð¸ Ð² Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ð¸ Ð¸ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸.')
    elif habit == 'Ð¿Ñ€Ð¾Ð²Ð¾Ð´Ð¸Ñ‚ÑŒ Ð¼ÐµÐ½ÑŒÑˆÐµ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ Ð² Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ðµ':
        text = 'Ð¿Ñ€Ð¸ÑÑ‹Ð»Ð°Ñ‚ÑŒ ÑÐºÑ€Ð¸Ð½ÑˆÐ¾Ñ‚ ÑÐºÑ€Ð°Ð½Ð½Ð¾Ð³Ð¾ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ Ð² Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ðµ.'
    else:
        return ''
    return (f'\n\nÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð´Ð»Ñ ÑÐ²Ð¾ÐµÐ¹ Ð¿Ñ€Ð¸Ð²Ñ‹Ñ‡ÐºÐ¸, Ñ‚Ñ‹ Ð¼Ð¾Ð¶ÐµÑˆÑŒ {text} ' +
            'Ð•ÑÐ»Ð¸ Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð½Ñ‹Ð¹ ÑÐ¿Ð¾ÑÐ¾Ð± Ñ‚ÐµÐ±Ðµ Ð½Ðµ Ð¿Ð¾Ð´Ñ…Ð¾Ð´Ð¸Ñ‚, Ð²Ñ‹ ' +
            'Ð²ÑÐµÐ³Ð´Ð° Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð´Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ð¸Ñ‚ÑŒÑÑ Ñ Ð½Ð°Ð¿Ð°Ñ€Ð½Ð¸ÐºÐ¾Ð¼ Ð¾ Ð¿Ñ€ÐµÐ´Ð¿Ð¾Ñ‡Ñ‚Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð¼ ' +
            'Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ðµ Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ñ Ð¸Ð½Ð´Ð¸Ð²Ð¸Ð´ÑƒÐ°Ð»ÑŒÐ½Ð¾. Ð’ÐµÐ´ÑŒ Ð³Ð»Ð°Ð²Ð½Ð¾Ðµ - ÑÑ‚Ð¾ ' +
            'Ð²Ð°Ñˆ ÐºÐ¾Ð¼Ñ„Ð¾Ñ€Ñ‚ Ð¸ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚!')


@router.chat_member(ChatMemberUpdatedFilter(IS_NOT_MEMBER >> IS_MEMBER))
async def on_user_join(event: ChatMemberUpdated):

    user = await bd_user_select(event.new_chat_member.user.id)
    await event.answer(
        f'ÐŸÑ€Ð¸Ð²ÐµÑ‚, {user["name"]}! Ð’ ÑÑ‚Ð¾Ð¼ Ñ‡Ð°Ñ‚Ðµ, Ð²Ñ‹ Ñ Ð½Ð°Ð¿Ð°Ñ€Ð½Ð¸ÐºÐ¾Ð¼ Ð±ÑƒÐ´ÐµÑ‚Ðµ ' +
        'Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´Ð°Ñ‚ÑŒ ÑÐ¾Ð±Ð»ÑŽÐ´ÐµÐ½Ð¸Ðµ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ñ… Ð²Ð°Ð¼Ð¸ Ð¿Ñ€Ð¸Ð²Ñ‹Ñ‡ÐµÐº.' +
        '\nÐÐ¾ Ð¿ÐµÑ€ÐµÐ´ Ñ‚ÐµÐ¼, ÐºÐ°Ðº Ð½Ð°Ñ‡Ð°Ñ‚ÑŒ, Ð²Ð¾Ñ‚ Ñ‚ÐµÐ±Ðµ Ð¿Ð°Ñ€Ð¾Ñ‡ÐºÐ° Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¹ðŸ‘‡')
    text = join_message(user["habit_choice"].lower())
    await event.answer(
        f'Ð¢Ð²Ð¾Ñ Ñ†ÐµÐ»ÑŒ - {user["habit_choice"].lower()} ' +
        f'{user["habit_frequency"]} Ñ€Ð°Ð·(-Ð°) Ð² Ð½ÐµÐ´ÐµÐ»ÑŽ' +
        '\n\nÐ’ Ñ‚ÐµÑ‡ÐµÐ½Ð¸Ðµ Ð±Ð»Ð¸Ð¶Ð°Ð¹ÑˆÐµÐ¹ Ð½ÐµÐ´ÐµÐ»Ð¸ Ð¿Ñ€Ð¸ÑÑ‹Ð»Ð°Ð¹ ÑÑŽÐ´Ð° Ñ„Ð¾Ñ‚Ð¾ Ð¸Ð»Ð¸ Ð²Ð¸Ð´ÐµÐ¾-' +
        'Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ñ Ñ‚Ð¾Ð³Ð¾, ÐºÐ°Ðº Ð²Ð½ÐµÐ´Ñ€ÑÐµÑˆÑŒ Ð¿Ñ€Ð¸Ð²Ñ‹Ñ‡ÐºÑƒ Ð² ÑÐ²Ð¾ÑŽ Ð¶Ð¸Ð·Ð½ÑŒ.' +
        f'{text}' +
        '\n\nÐ Ð°ÑÑÐºÐ°Ð·Ñ‹Ð²Ð°Ð¹Ñ‚Ðµ Ð¾ Ñ‚Ñ€ÑƒÐ´Ð½Ð¾ÑÑ‚ÑÑ… Ð¸ ÑƒÑÐ¿ÐµÑ…Ð°Ñ…, Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°Ð¹Ñ‚Ðµ Ð´Ñ€ÑƒÐ³ Ð´Ñ€ÑƒÐ³Ð°,' +
        ' Ð¸ Ð¿Ð¾Ð¼Ð½Ð¸Ñ‚Ðµ, Ñ‡Ñ‚Ð¾ Ð²Ñ‹ Ð·Ð´ÐµÑÑŒ Ð´Ð»Ñ Ñ‚Ð¾Ð³Ð¾, Ñ‡Ñ‚Ð¾Ð±Ñ‹ ÑÑ‚Ð°Ñ‚ÑŒ Ð»ÑƒÑ‡ÑˆÐµÐ¹ Ð²ÐµÑ€ÑÐ¸ÐµÐ¹ ÑÐµÐ±Ñ!')


@router.chat_member(ChatMemberUpdatedFilter(IS_MEMBER >> IS_NOT_MEMBER))
async def on_user_left(event: ChatMemberUpdated):
    await event.answer(f'ÐŸÑ€Ð¾Ñ‰Ð°Ð¹, {(event.old_chat_member.user.first_name)}')
